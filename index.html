<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="scrubber.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/6.6.4/wavesurfer.min.js" integrity="sha512-/OXj4FUgEscXKD5YhrFOjx2NWZ7gjGatMETWNd0z6CNyF/pPDUto2Fu3qE2qqh1kVn5or3jGogF01s1ioSts9A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script
      type="module"
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"
    ></script>
    <title>Waveform Annotation</title>
  </head>
  <body>
    <header>
      <h1>Audio Wave Player | HTML5 audio</h1>
    </header>

    <main>
      <div class="audio-details">
        <h2>
          Call with&nbsp;<a href="https://naveenpantra.com" target="_blank">Naveen Pantra</a>
          <ion-icon name="link"></ion-icon>
        </h2>
        <section class="player" style="--pointer-events: none; --opacity: 0.5">
          <div class="audio-duration">
            <span class="audio_current_time_text">00:00</span>/<span
              class="audio_total_duration"
              >Buffering...</span
            >
          </div>
          <div class="waveform-container">
            <div class="waveform">
              <div class="back-waveform"></div>
              <div class="front-waveform" style="--dx: 0%"></div>
              <div class="scrubber"></div>
<!--              <div class="waveform-comment" style="&#45;&#45;l: 3%">-->
<!--                <p class="waveform-commenter-label" title="Deepak Kumar">DK</p>-->
<!--                <p class="waveform-comment-text">Good introduction.</p>-->
<!--              </div>-->
<!--              <div class="waveform-comment" style="&#45;&#45;l: 30%">-->
<!--                <p class="waveform-commenter-label" title="Dony James">DJ</p>-->
<!--                <p class="waveform-comment-text">Make sale happen here!!</p>-->
<!--              </div>-->
<!--              <div class="waveform-comment" style="&#45;&#45;l: 40%">-->
<!--                <p class="waveform-commenter-label" title="Deepika Prajapati">-->
<!--                  DP-->
<!--                </p>-->
<!--                <p class="waveform-comment-text">This is a test comment.</p>-->
<!--              </div>-->
<!--              <div class="waveform-comment" style="&#45;&#45;l: 60%">-->
<!--                <p class="waveform-commenter-label" title="Pradeep Kumar Pamba">-->
<!--                  PP-->
<!--                </p>-->
<!--                <p class="waveform-comment-text waveform-comment-text-left">-->
<!--                  Introduce a new feature here.-->
<!--                </p>-->
<!--              </div>-->
<!--              <div class="waveform-comment" style="&#45;&#45;l: 80%">-->
<!--                <p class="waveform-commenter-label" title="Esrath Muqayyar">-->
<!--                  EM-->
<!--                </p>-->
<!--                <p class="waveform-comment-text waveform-comment-text-left">-->
<!--                  Point to note...-->
<!--                </p>-->
<!--              </div>-->
              <div class="live-comment-stick hide"></div>
            </div>
            <div class="context-menu-backdrop hide"></div>
            <div class="context-menu hide">
              <button class="add-cmt-btn">Add Comment</button>
              <button class="select-segment">Start Segmenting</button>
              <button class="select-segment">Copy URL</button>
              <button class="select-segment">Restart</button>
              <button class="exit-context-menu">Exit</button>
            </div>
          </div>
          <div class="live-comment-box hide">
            <img
              src="https://thumbs.dreamstime.com/b/digital-pixel-cyber-avatar-icon-computer-technology-security-hacking-black-white-face-person-vector-bit-abstract-symbol-design-169717259.jpg"
              alt="user"
              class="commenter-img"
            />
            <div class="commenter-details">
              <p>Naveen Pantra <span class="live-comment-time">00:23</span></p>
              <p>SDE | Sellular | Plivo</p>
            </div>
            <textarea
              class="live-commenter-comment"
              rows="5"
              placeholder="Your comment goes here!!!"
            ></textarea>
            <div class="commenter-comment-options">
              <button class="live-comment-cancel">Cancel</button>
              <button class="live-comment-save">Save</button>
            </div>
          </div>
          <div class="player-controls">
            <button class="player-playback-speed">
              <ion-icon name="speedometer-sharp"></ion-icon>
              <span class="playback-rate">1.0X</span>
            </button>
            <button class="seek_minus_10">
              <ion-icon name="play-back-sharp"></ion-icon>
            </button>
            <button class="audio_player_play">
              <ion-icon class="play-icon" name="play-sharp"></ion-icon>
              <ion-icon class="pause-icon hide" name="pause-sharp"></ion-icon>
            </button>
            <button class="seek_plus_10">
              <ion-icon name="play-forward-sharp"></ion-icon>
            </button>
            <button class="player-volume-ctrl">
              <input
                type="range"
                class="audio-volume-slider"
                min="0"
                max="1"
                value="0.8"
                step=".01"
              />
              <ion-icon class="volume-out" name="volume-high-sharp"></ion-icon>
              <ion-icon
                class="volume-muted hide"
                name="volume-off-sharp"
              ></ion-icon>
            </button>
          </div>
        </section>
      </div>
      <section class="comments-container">
        <h3>Comments Received...</h3>
        <div class="comment-box">
          <img
            src="https://previews.123rf.com/images/yupiramos/yupiramos1801/yupiramos180112164/93598955-pixelated-face-boy-video-game-avatar-vector-illustration-black-and-white-design.jpg"
            alt="user"
            class="commenter-img"
          />
          <div class="commenter-details">
            <p>Keeda Kola <span>01:03</span></p>
            <p>Analyst | Org</p>
          </div>
          <div class="commenter-comment">
            Right click on the waveform or audio player for a context menu
            to open and click on comment button
            to comment at a timestamp. <span class="mention">@NaveenPantra</span>
          </div>
          <div class="commenter-comment-options">
            <button class="comment-link">Like&middot;1</button>
            <button class="comment-reply">Reply</button>
          </div>
        </div>
        <div class="comment-box">
          <img
            src="https://64.media.tumblr.com/21037c5ac677d732c6dbbac18ac52946/tumblr_pe7vpgaXQC1tjl5mlo1_500.png"
            alt="user"
            class="commenter-img"
          />
          <div class="commenter-details">
            <p>Ee Nagaraniki Emaindi <span>01:40</span></p>
            <p>SDE-3 | Plivo</p>
          </div>
          <div class="commenter-comment">
            Click on the pins/nibs like UI on waveform to go the comment timestamp
            in audio Or hover on to see the trimmed comment text.
          </div>
          <div class="commenter-comment-options">
            <button class="comment-link">Like&middot;5</button>
            <button class="comment-reply">Reply</button>
          </div>
          <div class="commenter-replies">
            <div class="comment-box">
              <img
                src="https://cdna.artstation.com/p/assets/images/images/044/872/910/large/batu-unutmaz-aangwmjstoutln.jpg?1641374547"
                alt="user"
                class="commenter-img"
              />
              <div class="commenter-details">
                <p>Vivek</p>
                <p>SDM | Plivo</p>
              </div>
              <div class="commenter-comment">
                Check source <a href="https://github.com/NaveenPantra/call-recording-waveform" target="_blank">
                <em>@NaveenPantra/call-recording-waveform</em></a>
              </div>
              <div class="commenter-comment-options">
                <button class="comment-link">Like&middot;1</button>
                <button class="comment-reply">Reply</button>
              </div>
            </div>
          </div>
        </div>
        <div class="comment-box">
          <img
            src="https://thumbs.dreamstime.com/b/digital-pixel-cyber-avatar-icon-computer-technology-security-hacking-black-white-face-person-vector-bit-abstract-symbol-design-169717259.jpg"
            alt="user"
            class="commenter-img"
          />
          <div class="commenter-details">
            <p>Naveen Pantra <span>00:23</span></p>
            <p>SDE | Sellular | Plivo</p>
          </div>
          <div class="commenter-comment">
            See implementation details in React in this
            <a href="https://github.com/NaveenPantra/call-recording-waveform/wiki" target="_blank"><em>wiki</em></a>
          </div>
          <div class="commenter-comment-options">
            <button class="comment-link">Like&middot;10</button>
            <button class="comment-reply">Reply</button>
          </div>
        </div>
        <div class="comment-box">
          <img
            src="https://c8.alamy.com/comp/WXCX26/a-simple-monster-pixel-face-black-and-white-WXCX26.jpg"
            alt="user"
            class="commenter-img"
          />
          <div class="commenter-details">
            <p>Nani <span>00:10</span></p>
            <p>Software Engineer | Plivo</p>
          </div>
          <div class="commenter-comment">
            To see a video player POC that has been done for the same org visit <a href="https://github.com/NaveenPantra/video-player" target="_blank"><em>@NaveenPantra/video-player</em></a>
          </div>
          <div class="commenter-comment-options">
            <button class="comment-link">Like&middot;1</button>
            <button class="comment-reply">Reply</button>
          </div>
        </div>
        <div class="comment-box">
          <img
            src="https://cdnb.artstation.com/p/assets/images/images/047/467/831/large/zak-annable-sot-square-export.jpg?1647637583"
            alt="user"
            class="commenter-img"
          />
          <div class="commenter-details">
            <p>MR <span>00:59</span></p>
            <p>Product @ Intel</p>
          </div>
          <div class="commenter-comment">
            Just chill and play a CSS3 Grid based snake game <a href="https://github.com/NaveenPantra/snake-game" target="_blank"><em>@NaveenPantra/snake-game</em></a>
          </div>
          <div class="commenter-comment-options">
            <button class="comment-link">Like&middot;1</button>
            <button class="comment-reply">Reply</button>
          </div>
          <div class="commenter-replies">
            <div class="comment-box">
              <img
                src="https://e7.pngegg.com/pngimages/760/55/png-clipart-undertale-sprite-pixel-art-ninja-cartoon-fictional-character-thumbnail.png"
                alt="user"
                class="commenter-img"
              />
              <div class="commenter-details">
                <p>నవీన్ పాంట్రా</p>
                <p>Telugu | Translate</p>
              </div>
              <div class="commenter-comment">
                Has done one more POC on different media to compress them to check visit
                <a href="https://github.com/NaveenPantra/image-compression" target="_blank"><em>@NaveenPantra/image-compression</em></a>
              </div>
              <div class="commenter-comment-options">
                <button class="comment-link">Like&middot;1</button>
                <button class="comment-reply">Reply</button>
              </div>
            </div>
            <div class="comment-box">
              <img
                src="https://i.pinimg.com/474x/2c/54/c8/2c54c885bec02dc903a6904c68fbc0b8.jpg"
                alt="user"
                class="commenter-img"
              />
              <div class="commenter-details">
                <p>నవీన్ పాంట్రా</p>
                <p>Telugu | Translate</p>
              </div>
              <div class="commenter-comment">
                View my resume and hire me? <a href="https://naveenpantra.com/resume" target="_blank">@NaveenPantra/Resume</a>
              </div>
              <div class="commenter-comment-options">
                <button class="comment-link">Like&middot;1</button>
                <button class="comment-reply">Reply</button>
              </div>
            </div>
          </div>
        </div>
        <div class="comment-box">
          <img
            src="http://pixelartmaker-data-78746291193.nyc3.digitaloceanspaces.com/image/dc40f677393c655.png"
            alt="user"
            class="commenter-img"
          />
          <div class="commenter-details">
            <p>నవీన్ పాంట్రా <span>01:33</span></p>
            <p>Telugu | Translate</p>
          </div>
          <div class="commenter-comment">
            Lorem Ipsum is simply dummy text of the printing and typesetting
            industry. Lorem Ipsum has been the industry's standard dummy text
            ever since the 1500s, when an unknown printer.
          </div>
          <div class="commenter-comment-options">
            <button class="comment-link">Like&middot;1</button>
            <button class="comment-reply">Reply</button>
          </div>
        </div>
      </section>
    </main>

    <aside>
      <div class="call-details">
        <h4>Call Details</h4>
        <div class="call-basic-info">
          <p><ion-icon name="arrow-up-sharp"></ion-icon> Outgoing call</p>
          <p>Fri 20 May, 2022 - 13:32</p>
        </div>
        <div>
          <h5>Participants <span>(3)</span></h5>
          <p>Naveen Pantra, Micro Center, Radio Shack</p>
          <div class="participants-timeline-container">
            <div class="participants-info">
              <div class="participant-info">
                <h6>Naveen Pantra</h6>
                <p>+91 94934 64869</p>
              </div>
              <div class="participant-info">
                <h6>Micro Center</h6>
                <p>+91 89433 23452</p>
              </div>
              <div class="participant-info">
                <h6>Radio Shack</h6>
                <p>+1 (233) - 23323</p>
              </div>
            </div>
            <div class="participants-timeline">
              <div class="participant-timeline"></div>
              <div class="participant-timeline">
                <div
                  class="participant-time-line-segment"
                  style="--l: 0%; --w: 70%"
                ></div>
              </div>
              <div class="participant-timeline">
                <div
                  class="participant-time-line-segment"
                  style="--l: 5%; --w: 30%"
                ></div>

                <div
                  class="participant-time-line-segment"
                  style="--l: 60%; --w: 40%"
                ></div>
              </div>
              <div class="participant-timeline-progress"></div>
            </div>
          </div>
        </div>
        <div>
          <h5>Disposition</h5>
          <p>Nothing</p>
        </div>
        <div>
          <h5>Purpose</h5>
          <p>Nothing</p>
        </div>
        <div>
          <h5>Notes</h5>
          <p>
            <br />
            This project serves as a Proof of Concept (POC) for a bufferable audio player.
            <br /><br />
            <strong><em>Issue:</em></strong>
            For audio files exceeding 10MB, typical for phone call recordings surpassing 30 minutes, Wavesurfer currently necessitates the pre-download of the audio file to generate the waveform.
            <br /><br />
            <strong><em>Resolution:</em></strong>
            The solution involves the utilization of an HTML5 DOM audio element. Users can initiate audio playback without the need to fully download the audio file initially. The audio file is fetched in the background and then supplied to Wavesurfer to obtain PCM data. Subsequently, upon resolving and normalizing the PCM data, the waveform segments are rendered on the screen.
            years
          </p>
        </div>
        <div>
          <h5>Sample Implementation</h5>
          <p>Open in chorme/webkit browsers <a href="https://external.sellulardev.io/recordings/748096ed-516c-471d-ab0f-51505749f4f4">Sellular call recording</a></p> 
        </div>
      </div>

      <div class="wave_surfer hide"></div>
      <audio
        class="dom_audio_player soft-hide"
        src="./audio.m4a"
        preload="metadata"
        hidden
      ></audio>
    </aside>

    <script src="scrubber.js"></script>
    <script src="audioControls.js"></script>
    <script src="waveform.js"></script>
    <script src="app.js"></script>
    <script src="./commenter.js"></script>
  </body>
</html>
